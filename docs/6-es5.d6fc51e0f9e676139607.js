function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{QskC:function(t,e,r){"use strict";r.r(e);var n,i,o,a,s=r("ofXK"),c=r("3Pt+"),u=r("tyNb"),l=r("Kj3r"),f=r("vkgz"),p=r("fXoL"),b=r("4ZtF"),d=r("itXk"),h=r("lJxs"),y=r("eIep"),_=r("mrSG"),g=((i=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,{ui:{productsInfiniteList:{currentPage:1,pageSize:6,pageIds:[],hasReachedLimit:!1}}}))}return _inherits(e,t),_createClass(e,[{key:"updateProductsInfiniteList",value:function(t){this.update({ui:Object.assign(Object.assign({},this.getValue().ui),{productsInfiniteList:t})})}}]),e}(b.a)).\u0275fac=function(t){return new(t||i)},i.\u0275prov=p.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i=Object(_.b)([Object(b.c)({name:"products"})],i)),v=((n=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).loading$=r.selectLoading(),r.infiniteListShowMoreIsDisabled$=Object(d.a)([r.selectLoading(),r.select((function(t){return t.ui.productsInfiniteList.hasReachedLimit}))]).pipe(Object(h.a)((function(t){var e=_slicedToArray(t,2),r=e[0],n=e[1];return r||n}))),r.page$=r.select((function(t){return t.ui.productsInfiniteList.pageIds})).pipe(Object(y.a)((function(t){return r.selectMany(t)}))),r}return _inherits(e,t),_createClass(e,[{key:"getProductsInfiniteList",value:function(){return this.getValue().ui.productsInfiniteList}}]),e}(b.b)).\u0275fac=function(t){return new(t||n)(p.Sb(g))},n.\u0275prov=p.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),C=r("PqYM"),m=r("7o/Q"),O=function(){function t(e){_classCallCheck(this,t),this.value=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new k(t,this.value))}}]),t}(),k=function(t){function e(t,r){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).value=r,n}return _inherits(e,t),_createClass(e,[{key:"_next",value:function(t){this.destination.next(this.value)}}]),e}(m.a),I=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=e.length,n="",i=0;i<t;i++)n+=e.charAt(Math.floor(Math.random()*r));return n},P=function(){for(var t=[],e=0;e<100;e++)t.push({id:Math.random(),name:I(10),price:Number((20*Math.random()).toFixed(2))});return t}(),w=((a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getFilteredList",value:function(t){return"string"==typeof t?P.filter((function(e){return e.name.includes(t)})):t instanceof Map?P:void 0}},{key:"getPage",value:function(t,e,r){var n,i=this.getFilteredList(r),o=(t-1)*e,a=o+e;return Object(C.a)(1e3).pipe((n={count:i.length,data:i.slice(o,a)},function(t){return t.lift(new O(n))}))}}]),t}()).\u0275fac=function(t){return new(t||a)},a.\u0275prov=p.Fb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),j=((o=function(){function t(e,r,n){_classCallCheck(this,t),this.productsStore=e,this.productsApi=r,this.productsQuery=n}return _createClass(t,[{key:"loadProductsForInfiniteList",value:function(t,e,r,n){var i=this;this.productsStore.setLoading(!0),this.productsApi.getPage(t,e,r).pipe(Object(f.a)((function(t){return i.productsStore.upsertMany(t.data)})),Object(f.a)((function(t){return i.productsStore.setLoading(!1)})),Object(f.a)((function(r){var o=r.data.map((function(t){return t.id})),a=n?_toConsumableArray(o):[].concat(_toConsumableArray(i.productsQuery.getProductsInfiniteList().pageIds),_toConsumableArray(o));i.productsStore.updateProductsInfiniteList({pageIds:a,hasReachedLimit:r.count===a.length,currentPage:t,pageSize:e})}))).subscribe()}}]),t}()).\u0275fac=function(t){return new(t||o)(p.Sb(g),p.Sb(w),p.Sb(v))},o.\u0275prov=p.Fb({token:o,factory:o.\u0275fac,providedIn:"root"}),o);function L(t,e){if(1&t&&(p.Ob(0,"li"),p.hc(1),p.Nb()),2&t){var r=e.$implicit;p.zb(1),p.jc(" ",r.name," - ",r.price.toFixed(2)," ")}}function F(t,e){1&t&&(p.Ob(0,"p"),p.hc(1," Cargando... "),p.Nb())}var S,A,M=[{path:"",component:(S=function(){function t(e,r,n){_classCallCheck(this,t),this.productsQuery=e,this.productsService=r,this.fb=n,this._buildForm(),this._initFormListeners()}return _createClass(t,[{key:"_initFormListeners",value:function(){var t=this;this.queryFC.valueChanges.pipe(Object(l.a)(300),Object(f.a)((function(e){return t.productsService.loadProductsForInfiniteList(1,20,e,!0)}))).subscribe()}},{key:"_buildForm",value:function(){this.queryFC=this.fb.control("")}},{key:"_loadFirstResults",value:function(){this.productsService.loadProductsForInfiniteList(1,20,this.queryFC.value,!1)}},{key:"showMore",value:function(){this.productsService.loadProductsForInfiniteList(this.productsQuery.getProductsInfiniteList().currentPage+1,20,this.queryFC.value,!1)}},{key:"ngOnInit",value:function(){this._loadFirstResults()}}]),t}(),S.\u0275fac=function(t){return new(t||S)(p.Jb(v),p.Jb(j),p.Jb(c.b))},S.\u0275cmp=p.Db({type:S,selectors:[["app-akita-store-pagination"]],decls:12,vars:10,consts:[["type","text","placeholder","Buscar por nombre",3,"formControl"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"disabled","click"]],template:function(t,e){1&t&&(p.Ob(0,"main"),p.Ob(1,"h1"),p.hc(2,"Productos"),p.Nb(),p.Kb(3,"input",0),p.Ob(4,"ul"),p.gc(5,L,2,2,"li",1),p.Zb(6,"async"),p.Nb(),p.gc(7,F,2,0,"p",2),p.Zb(8,"async"),p.Ob(9,"button",3),p.Wb("click",(function(){return e.showMore()})),p.Zb(10,"async"),p.hc(11,"Mostrar m\xe1s"),p.Nb(),p.Nb()),2&t&&(p.zb(3),p.bc("formControl",e.queryFC),p.zb(2),p.bc("ngForOf",p.ac(6,4,e.productsQuery.page$)),p.zb(2),p.bc("ngIf",p.ac(8,6,e.productsQuery.loading$)),p.zb(2),p.bc("disabled",p.ac(10,8,e.productsQuery.infiniteListShowMoreIsDisabled$)))},directives:[c.a,c.e,c.c,s.i,s.j],pipes:[s.b],styles:[""]}),S)}],R=((A=function t(){_classCallCheck(this,t)}).\u0275mod=p.Hb({type:A}),A.\u0275inj=p.Gb({factory:function(t){return new(t||A)},imports:[[u.b.forChild(M)],u.b]}),A);r.d(e,"AkitaStorePaginationModule",(function(){return z}));var T,z=((T=function t(){_classCallCheck(this,t)}).\u0275mod=p.Hb({type:T}),T.\u0275inj=p.Gb({factory:function(t){return new(t||T)},imports:[[s.c,R,c.h]]}),T)}}]);